---
description: https://attack.mitre.org/techniques/T1087/002/
---

# Domain Account

**ATT\&CK ID:** [T1087.002](https://attack.mitre.org/techniques/T1087/002/)

**Permissions Required:** <mark style="color:orange;">**Various**</mark>

**Description**

Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior.

## Techniques (Linux)

### Crackmapexec

```bash
# Unauthenticated / Null Session
crackmapexec smb <IP> --users

# Authenticated
crackmapexec smb <IP> -u <Username> -p <Password> --users
```

### Enum4Linux

```bash
# Unauthenticated / Null Session
enum4linux -U <IP>  | grep "user:" | cut -f2 -d"[" | cut -f1 -d"]" | sort

# Authenticated
enum4linux -U <IP> -u <Username> -p <Password>  | grep "user:" | cut -f2 -d"[" | cut -f1 -d"]" | sort
```

### Kerbrute

```
kerbrute userenum -d <Domain.local> --dc <DC-IP> /opt/names.txt
```

### Windapsearch

```python
# Unauthenticated / NULL Session
windapsearch.py --dc-ip <IP> -u "" -U | grep 

# Authenticated
windapsearch.py --dc-ip <IP> -u <Domain\\User> -p <Password> -U

# All Domain users to list
python3 windapsearch.py --dc-ip <IP>  -u "" -U | grep userPrincipalName: | sed 's/userPrincipalName: //' | sort > DomainUsers.txt 
```

## Techniques (Windows)

### CMD&#x20;

<pre><code><strong>net users /domain
</strong></code></pre>

### PowerShell

```powershell
# List all users and properties
Get-ADuser -Filter * -Properties *

# List all Domain user accounts and store in list
Get-ADUser -Filter * -Properties SamAccountName | Select -ExpandProperty SamAccountName | Sort | Out-File DomainUsers.txt
```

### PowerView

```powershell
# List total number of user accounts
(Get-DomainUser).count

# List all user accounts in Domain
Get-DomainUser

# List all active Domain user accounts and store in list
Get-NetUser -UACFilter NOT_ACCOUNTDISABLE -Properties SamAccountName | Sort | Select -ExpandProperty SamAccountName | Out-File DomainUsers.txt
```
