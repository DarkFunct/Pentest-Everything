# SAM

### Syntax

<pre class="language-powershell"><code class="lang-powershell"><strong>#  General Syntax
</strong><strong>PsMapExec -Username [User] -Password [Pass] -targets [All] -Module [Module] -Method [Method]
</strong><strong>
</strong><strong># Example
</strong><strong>PsMapExec -Username Admin -Password 12345 -targets All -Method WMI -Module SAM
</strong></code></pre>

**Supported Protocols**

* WMI
* WinRM
* PsExec

**Options**

* Parse

**Known Issues**

This module does not currently work on Windows Server 2012  and is currently being looked into.

### Usage

{% code overflow="wrap" %}
```powershell
# Standard execution
PsMapExec -Username [User] -Password [Pass] -targets [All] -Module SAM -Method [Method]
```
{% endcode %}

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

{% code overflow="wrap" %}
```powershell
# With Parsing
PsMapExec -Username [User] -Password [Pass] -targets [All] -Module SAM -Method [Method] -Option Parse
```
{% endcode %}

The parsing option will parse the results from each SAM dump and display hashes which are reused across different systems.&#x20;

The output appends the system name from which the hash has been pulled from to the name for easy identification.

<figure><img src="../../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>
